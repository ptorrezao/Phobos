@{
    List<UserMessageViewModel> userMessages = ViewBag.UserMessages;
}
<li class="dropdown messages-menu">
    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
        <i class="fa fa-envelope-o"></i>
        @if (userMessages.Count > 0)
        {
            <span class="label label-success">@userMessages.Count</span>
        }
    </a>
    @if (userMessages.Count > 0)
    {
        <ul class="dropdown-menu">
            <li class="header">You have @userMessages.Count messages</li>
            <li>
                <ul class="menu">
                    <li>
                        @foreach (var message in userMessages)
                        {
                            <a href="#">
                                <div class="pull-left">
                                    <img src="@message.User.ImageUrl" class="img-circle" alt="@message.User.FullName">
                                </div>
                                <h4>
                                    @message.Title

                                    <small><i class="fa fa-clock-o"></i> <span class="timeago" title="@message.SentDate.ToString("yyyy-MM-ddTHH:mm:ssZ")"></span> </small>
                                </h4>
                                <p>@message.Message</p>
                            </a>
                        }
                    </li>
                </ul>
            </li>
            <li class="footer"><a href="#">See All Messages</a></li>
        </ul>
    }

</li>
